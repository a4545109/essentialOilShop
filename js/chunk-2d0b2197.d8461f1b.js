(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b2197"],{2355:function(t,s,a){"use strict";a.r(s);var e=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(s){t.isLoading=s}}}),t._m(0),a("div",{staticClass:"container"},[t.carts.length>0?a("div",{staticClass:"row d-flex justify-content-center"},[a("div",{staticClass:"col-md-10"},[a("div",{staticClass:"text-right mb-3"},[a("button",{staticClass:"btn btn-outline-danger",attrs:{type:"button"},on:{click:t.removeAllCarts}},[t._v(" 刪除所有品項 "),a("i",{staticClass:"far fa-trash-alt"})])]),a("div",{staticClass:"table-responsive",staticStyle:{"white-space":"nowrap"}},[a("table",{staticClass:"table"},[t._m(1),a("tbody",{staticClass:"text-center"},t._l(t.carts,(function(s){return a("tr",{key:s.product.id+1},[a("td",{staticClass:"align-middle"},[a("div",{staticClass:"delete"},[a("i",{staticClass:"fas fa-minus-circle",on:{click:function(a){return t.removeItemCart(s.product.id)}}})])]),a("td",{staticClass:"thumbnail"},[a("img",{attrs:{src:s.product.imageUrl,alt:"產品縮圖"}})]),a("td",{staticClass:"align-middle productName"},[t._v(t._s(s.product.title))]),a("td",{staticClass:"align-middle"},[a("div",{staticClass:"input-group"},[a("div",{staticClass:"input-group-append numberBox"},[a("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button",disabled:1===s.quantity},on:{click:function(a){s.quantity--,t.updateQuantity(s.product.id,s.quantity)}}},[t._v("- "),t.status.loadingItem===s.id?a("span",{staticClass:"spinner-grow spinner-grow-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e()])]),a("input",{directives:[{name:"model",rawName:"v-model",value:s.quantity,expression:"item.quantity"}],staticClass:"form-control text-center",attrs:{type:"number",min:"1"},domProps:{value:s.quantity},on:{change:function(a){return t.updateQuantity(s.product.id,s.quantity)},input:function(a){a.target.composing||t.$set(s,"quantity",a.target.value)}}}),a("div",{staticClass:"input-group-prepend numberBox"},[a("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button"},on:{click:function(a){s.quantity++,t.updateQuantity(s.product.id,s.quantity)}}},[t._v("+ "),t.status.loadingItem===s.id?a("span",{staticClass:"spinner-grow spinner-grow-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e()])])])]),a("td",{staticClass:"align-middle unit"},[t._v(t._s(s.product.unit))]),a("td",{staticClass:"align-middle text-right"},[t._v(t._s(t._f("thousands")(s.product.price)))])])})),0)])]),a("div",{staticClass:"row d-flex flex-row-reverse"},[a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"input-group mb-3 input-group-sm"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon_code,expression:"coupon_code"}],staticClass:"form-control",attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.coupon_code},on:{input:function(s){s.target.composing||(t.coupon_code=s.target.value)}}}),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button"},on:{click:t.addCoupon}},[t._v(" 套用優惠碼 ")])])])])]),a("div",{staticClass:"row d-flex flex-row-reverse mt-2 mb-2"},[a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"totalCost d-flex justify-content-between pr-1"},[a("span",{staticClass:"d-inline mr-3"},[t._v("消費總計")]),a("span",[t._v("NT"+t._s(t._f("thousands")(t.cartTotal)))])]),a("div",{staticClass:"totalDiscount d-flex justify-content-between pr-1"},[a("span",{staticClass:"d-inline text-success mr-3"},[t._v("優惠折扣")]),a("span",{staticClass:"text-success"},[t._v("NT"+t._s(t._f("thousands")(t.cartTotal-t.cartTotal*(t.coupon.percent/100)||0)))])])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"totalAmount p-2"},[a("p",{staticClass:"text-right"},[t._v("訂單內有 "),a("span",{staticClass:"text-danger"},[t._v(t._s(t.quantity))]),t._v(" 件商品， "),a("span",[t._v("本筆訂單總金額 "),a("span",{staticClass:"text-danger"},[t._v(t._s(t._f("thousands")(parseInt(t.cartTotal*(t.coupon.percent/100))||t.cartTotal)))])])])])])]),a("div",{staticClass:"row mt-3 mb-5"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("button",{staticClass:"btn btn-primary btn-block text-white rounded-0",attrs:{type:"button"},on:{click:t.continueShopping}},[t._v(" 繼續購物 ")])]),a("div",{staticClass:"col-6"},[a("button",{staticClass:"btn btn-secondary text-white btn-block rounded-0",attrs:{type:"button"},on:{click:t.nextStep}},[t._v(" 下一步 ")])])])])])])]):a("div",{staticClass:"emptyCarts d-flex justify-content-center my-7"},[a("h4",{staticClass:"mb-3 warning-text"},[t._v("哎唷 ! 購物車無商品，快去逛逛 "),a("router-link",{staticClass:"text-dark mt-5 mt-3",attrs:{to:"/products"}},[a("i",{staticClass:"fas fa-chevron-left mr-2"}),t._v(" 繼續購物 ")])],1)])])],1)},i=[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"container pt-5 mb-5"},[a("div",{staticClass:"row d-flex justify-content-center"},[a("div",{staticClass:"col-12 col-sm-10"},[a("ul",{staticClass:"setp d-flex justify-content-between"},[a("li",{staticClass:"setp-item active bg-primary text-white"},[a("div",{staticClass:"stepContent"},[a("span",{staticClass:"text-center"},[t._v("STEP1")]),a("br"),a("span",[t._v("購物清單")])])]),a("li",{staticClass:"setp-item"},[a("div",{staticClass:"stepContent"},[a("span",{staticClass:"text-center"},[t._v("STEP2")]),a("br"),a("span",[t._v("填寫資料")])])]),a("li",{staticClass:"setp-item"},[a("div",{staticClass:"stepContent"},[a("span",{staticClass:"text-center"},[t._v("STEP3")]),a("br"),a("span",[t._v("成功結帳")])])])])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("thead",{staticClass:"cartTableTitle text-center font-weight-bold table-borderless"},[a("th",[t._v("刪除")]),a("th",{staticClass:"thumbnail"},[t._v("縮圖")]),a("th",[t._v("商品名稱")]),a("th",{staticClass:"cartNum"},[t._v("數量")]),a("th",{staticClass:"unit"},[t._v("單位")]),a("th",[t._v("單價")])])}],n=(a("99af"),a("4160"),a("159b"),{name:"Cart",data:function(){return{carts:[],cartTotal:0,quantity:0,isLoading:!1,coupon:{},coupon_code:"",status:{loadingItem:""}}},methods:{getCarts:function(){var t=this,s="".concat("https://course-ec-api.hexschool.io","/api/").concat("758e049c-13ea-4895-88ba-30bd03b23992","/ec/shopping");this.isLoading=!0,this.$http.get(s).then((function(s){t.carts=s.data.data,t.quantity=s.data.data.length,t.isLoading=!1,t.updateTotal()})).catch((function(){t.$bus.$emit("message:push","發生錯誤","danger"),t.isLoading=!1}))},updateQuantity:function(t,s){var a=this,e="".concat("https://course-ec-api.hexschool.io","/api/").concat("758e049c-13ea-4895-88ba-30bd03b23992","/ec/shopping"),i={product:t,quantity:s};this.$http.patch(e,i).then((function(t){a.cartTotal=0,a.getCarts()})).catch((function(){a.$bus.$emit("message:push","發生錯誤","danger")}))},updateTotal:function(){var t=this;this.carts.forEach((function(s){t.cartTotal+=s.product.price*s.quantity}))},removeAllCarts:function(){var t=this,s="".concat("https://course-ec-api.hexschool.io","/api/").concat("758e049c-13ea-4895-88ba-30bd03b23992","/ec/shopping/all/product");this.$http.delete(s).then((function(s){t.getCarts(),t.cartTotal=0,t.$bus.$emit("updateQuantity")}))},removeItemCart:function(t){var s=this,a="".concat("https://course-ec-api.hexschool.io","/api/").concat("758e049c-13ea-4895-88ba-30bd03b23992","/ec/shopping/").concat(t);this.$http.delete(a).then((function(t){s.getCarts(),s.$bus.$emit("updateQuantity")}))},addCoupon:function(){var t=this,s="".concat("https://course-ec-api.hexschool.io","/api/").concat("758e049c-13ea-4895-88ba-30bd03b23992","/ec/coupon/search");this.$http.post(s,{code:this.coupon_code}).then((function(s){t.$bus.$emit("message:push","成功使用此優惠券","success"),t.coupon=s.data.data})).catch((function(){t.coupon_code?t.$bus.$emit("message:push","沒有此優惠券 ╥﹏╥","danger"):t.$bus.$emit("message:push","請輸入優惠券 ╥﹏╥","danger")}))},continueShopping:function(){this.$router.push("/products")},nextStep:function(){this.$router.push("/customer_profile")}},created:function(){this.getCarts()}}),c=n,o=a("2877"),r=Object(o["a"])(c,e,i,!1,null,null,null);s["default"]=r.exports}}]);
//# sourceMappingURL=chunk-2d0b2197.d8461f1b.js.map